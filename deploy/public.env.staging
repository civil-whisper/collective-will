# Public, non-secret staging configuration (tracked in git)

# --- Public endpoints / transport ---
APP_PUBLIC_BASE_URL=https://staging.collectivewill.org
EVOLUTION_API_URL=http://evolution:8080
TELEGRAM_BOT_USERNAME=collective_will_dev_bot
EMAIL_FROM=noreply@collectivewill.org

# --- Deploy ports / image tag ---
IMAGE_TAG=staging
BACKEND_PORT=8100
WEB_PORT=3100
EVOLUTION_PORT=8180

# --- Runtime networking / timeouts ---
CORS_ALLOW_ORIGINS=https://staging.collectivewill.org,http://localhost:3000
OPS_CONSOLE_ENABLED=true
OPS_CONSOLE_SHOW_IN_NAV=true
OPS_CONSOLE_REQUIRE_ADMIN=false
TELEGRAM_HTTP_TIMEOUT_SECONDS=20
WHATSAPP_HTTP_TIMEOUT_SECONDS=20
EMAIL_HTTP_TIMEOUT_SECONDS=10
WITNESS_HTTP_TIMEOUT_SECONDS=20

# --- Pipeline / clustering cadence ---
PIPELINE_INTERVAL_HOURS=0.1
PIPELINE_MIN_INTERVAL_HOURS=0.01
VOTING_CYCLE_HOURS=2
MIN_CLUSTER_SIZE=2
CLUSTER_MIN_SAMPLES=1
CLUSTER_RANDOM_SEED=7
CLUSTER_VARIANCE_MIN_CANDIDATES=20
CLUSTER_VARIANCE_STABILITY_THRESHOLD=0.6
CLUSTER_VARIANCE_RANDOM_SEEDS=7,11,13
MIN_PREBALLOT_ENDORSEMENTS=1

# --- Submission / voting thresholds ---
MIN_ACCOUNT_AGE_HOURS=0
MAX_SUBMISSIONS_PER_DAY=50
REQUIRE_CONTRIBUTION_FOR_VOTE=false
MAX_VOTE_SUBMISSIONS_PER_CYCLE=2
MAX_SIGNUPS_PER_DOMAIN_PER_DAY=3
MAX_SIGNUPS_PER_IP_PER_DAY=10
SIGNUP_DOMAIN_DIVERSITY_THRESHOLD=5
BURST_QUARANTINE_THRESHOLD_COUNT=3
BURST_QUARANTINE_WINDOW_MINUTES=5
MAJOR_EMAIL_PROVIDERS=gmail.com,outlook.com,yahoo.com,protonmail.com

# --- Identity / token expiry ---
MAGIC_LINK_EXPIRY_MINUTES=15
LINKING_CODE_EXPIRY_MINUTES=60

# --- Dispute metrics / escalation ---
DISPUTE_METRICS_LOOKBACK_DAYS=7
DISPUTE_RATE_TUNING_THRESHOLD=0.05
DISPUTE_DISAGREEMENT_TUNING_THRESHOLD=0.30
DISPUTE_ENSEMBLE_TEMPERATURE=0.1

# --- Model configuration ---
CANONICALIZATION_MODEL=gemini-3.1-pro-preview
CANONICALIZATION_FALLBACK_MODEL=claude-sonnet-4-20250514
FARSI_MESSAGES_MODEL=gemini-3.1-pro-preview
FARSI_MESSAGES_FALLBACK_MODEL=claude-sonnet-4-20250514
ENGLISH_REASONING_MODEL=gemini-3.1-pro-preview
ENGLISH_REASONING_FALLBACK_MODEL=claude-sonnet-4-20250514
OPTION_GENERATION_MODEL=gemini-3.1-pro-preview
OPTION_GENERATION_FALLBACK_MODEL=claude-sonnet-4-20250514
DISPUTE_RESOLUTION_MODEL=gemini-3.1-pro-preview
DISPUTE_RESOLUTION_FALLBACK_MODEL=claude-sonnet-4-20250514
DISPUTE_RESOLUTION_ENSEMBLE_MODELS=gemini-3.1-pro-preview,claude-sonnet-4-20250514
DISPUTE_RESOLUTION_CONFIDENCE_THRESHOLD=0.75
EMBEDDING_MODEL=gemini-embedding-001
EMBEDDING_FALLBACK_MODEL=text-embedding-3-large

# --- LLM call behavior ---
LLM_MAX_RETRIES=3
LLM_COMPLETION_RETRY_BACKOFF_BASE_SECONDS=0.1
LLM_EMBEDDING_RETRY_BACKOFF_BASE_SECONDS=0.5
LLM_EMBED_BATCH_SIZE=64
LLM_DEFAULT_MAX_TOKENS=1024
LLM_DEFAULT_TEMPERATURE=0
LLM_COMPLETION_TIMEOUT_SECONDS=60
LLM_EMBEDDING_TIMEOUT_SECONDS=60
LLM_EMBEDDING_DIMENSIONS=1024
LLM_TRANSIENT_STATUS_CODES=429,500,502,503
LLM_NON_RETRIABLE_STATUS_CODES=400,401

# --- DB pool ---
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT_SECONDS=30
DB_ECHO_SQL=false
